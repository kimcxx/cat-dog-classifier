# 🐱🐶 智能猫狗识别器

一个基于深度学习的猫狗识别Web应用，准确率99.39%，支持智能拒绝非猫狗图片。

## ✨ 核心特性

✅ **高准确率**: 99.39%验证准确率，狗识别100%准确  
✅ **智能拒绝**: 自动识别并拒绝非猫狗图片  
✅ **友好界面**: 拖放上传，实时预览，详细结果  
✅ **技术先进**: ResNet50 + 迁移学习 + 数据增强  
✅ **拒绝机制**: 置信度阈值85%，概率差异30%  

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动应用
```bash
python web/app.py
```

### 3. 访问应用
打开浏览器访问: **http://localhost:5000**

## 📸 使用示例

1. **上传猫图片** → 🐱 + 高置信度  
2. **上传狗图片** → 🐶 + 高置信度  
3. **上传人物图片** → ❓ + "既不是猫也不是狗"  
4. **上传模糊图片** → ❓ + "难以确定"  

## 📊 性能数据

| 指标 | 数值 |
|------|------|
| 总体准确率 | 99.39% |
| 狗识别准确率 | 100.00% |
| 猫识别准确率 | 98.12% |
| 模型大小 | 102MB |
| 训练数据 | 2,000+ 张图片 |
| 验证数据 | 1,478 张图片 |

## 🏗️ 项目结构

```
.
├── cat_dog_model.pth            # 训练好的模型
├── requirements.txt             # Python依赖
├── .gitignore                   # Git忽略规则
├── web/                         # Web应用
│   ├── app.py                  # Flask服务器
│   └── static/                 # 前端文件
│       ├── index.html          # 主页面
│       ├── app.js              # 交互逻辑
│       └── style.css           # 样式表
└── README.md                   # 项目文档
```

## 🔧 Web应用详情

### 🎯 功能特点
- **拖拽上传**: 支持拖拽图片到页面  
- **点击选择**: 点击按钮选择图片文件  
- **实时识别**: 上传后自动识别（约1-2秒）  
- **详细结果**: 显示预测结果、置信度、概率分布  
- **美观界面**: 渐变背景、动画效果  

### 🔧 智能拒绝机制
1. **置信度阈值**（85%）：置信度<85%时返回"既不是猫也不是狗"  
2. **概率差异阈值**（30%）：概率差异<30%时返回"难以确定"  
3. **中等置信度处理**: 置信度85%-90%时提示"可能不是猫或狗"  

### 🏗️ 技术栈
- **后端**: Flask + Python  
- **前端**: HTML5 + CSS3 + JavaScript  
- **深度学习**: PyTorch + ResNet50  
- **模型来源**: 在Oxford-IIIT Pet Dataset上微调  

## 📈 技术细节

### 模型架构
- **基础模型**: ResNet50 (ImageNet预训练)  
- **分类头**: 512维全连接层 + Dropout  
- **输出**: 2类别 (猫/狗)  

### 训练策略
- **迁移学习**: 冻结底层，训练分类层  
- **数据增强**: 随机裁剪、翻转、旋转、颜色抖动  
- **优化器**: Adam + 学习率调度  
- **早停机制**: 防止过拟合  

### 训练参数
- 学习率: 0.0005  
- 批量大小: 16  
- 训练轮数: 10 (早停机制)  
- 数据增强: 随机裁剪、翻转、旋转、颜色抖动  

## 📈 改进历程

| 阶段 | 准确率 | 改进内容 |
|------|--------|----------|
| 原始 | ~60% | 基础模型，多品种分类 |
| 优化 | ~85% | 二分类，数据增强 |
| 改进 | ~95% | ResNet50，迁移学习 |
| 最终 | **99.39%** | 拒绝机制，参数调优 |

## 🌐 部署指南

### 本地运行
```bash
pip install -r requirements.txt
python web/app.py
```

### 云服务器部署
- **PythonAnywhere**（免费）: 上传文件，配置WSGI指向`web/app.py`  
- **Heroku**（免费层）: 创建Procfile和runtime.txt  
- **Vercel/Netlify**: 需要Docker容器化  
- **阿里云/腾讯云**: 国内访问速度快  

### 环境要求
- **Python版本**: 3.8+（推荐3.9）  
- **内存**: 至少2GB RAM  
- **存储**: 至少200MB可用空间  
- **网络**: 支持HTTP/HTTPS  

## 🎯 使用场景

- **宠物识别**: 识别宠物猫狗  
- **内容审核**: 过滤非宠物图片  
- **教育演示**: 深度学习教学案例  
- **API服务**: 提供识别接口  

## 🔧 扩展建议

### 性能优化
1. 添加GPU支持  
2. 实现模型缓存  
3. 添加批量预测  

### 功能扩展
1. 支持更多动物类别  
2. 添加用户账户系统  
3. 保存预测历史  
4. 支持视频流分析  

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

本项目仅供学习和研究使用。

## 📞 支持

如有问题，请查看文档或提交Issue。

---

**项目状态**: ✅ 已完成  
**最后更新**: 2026年2月14日  
**模型准确率**: 🎯 99.39%  
**Web应用**: 运行中  
**访问**: http://localhost:5000  
**GitHub就绪**: ✅ 已优化  
**仓库大小**: ~103MB (模型102MB + 代码1MB)